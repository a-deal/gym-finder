#!/usr/bin/env python3
"""
Metropolitan Area Definitions for GymIntel
Comprehensive ZIP code mappings for major metropolitan areas
"""

from dataclasses import dataclass
from typing import Dict, List, Optional


@dataclass
class MetropolitanArea:
    """Represents a metropolitan area with its ZIP codes and metadata"""

    name: str
    code: str
    description: str
    zip_codes: List[str]
    state: str
    population: Optional[int] = None
    density_category: str = "medium"  # low, medium, high, very_high
    market_characteristics: List[str] = None

    def __post_init__(self):
        if self.market_characteristics is None:
            self.market_characteristics = []


# Metropolitan Area Definitions
METROPOLITAN_AREAS: Dict[str, MetropolitanArea] = {
    # New York City Metropolitan Area
    "nyc": MetropolitanArea(
        name="New York City",
        code="nyc",
        description="Manhattan, Brooklyn, Queens, Bronx, Staten Island",
        state="NY",
        population=8_300_000,
        density_category="very_high",
        market_characteristics=[
            "premium_market",
            "high_competition",
            "diverse_offerings",
            "boutique_studios",
            "corporate_chains",
            "luxury_facilities",
        ],
        zip_codes=[
            # Manhattan - Core Business Districts
            "10001",
            "10002",
            "10003",
            "10004",
            "10005",
            "10006",
            "10007",
            "10009",
            "10010",
            "10011",
            "10012",
            "10013",
            "10014",
            "10016",
            "10017",
            "10018",
            "10019",
            "10020",
            "10021",
            "10022",
            "10023",
            "10024",
            "10025",
            "10026",
            "10027",
            "10028",
            "10029",
            "10030",
            "10031",
            "10032",
            "10033",
            "10034",
            "10035",
            "10036",
            "10037",
            "10038",
            "10039",
            "10040",
            # Brooklyn - Major Neighborhoods
            "11201",
            "11205",
            "11206",
            "11207",
            "11208",
            "11209",
            "11210",
            "11211",
            "11212",
            "11213",
            "11214",
            "11215",
            "11216",
            "11217",
            "11218",
            "11219",
            "11220",
            "11221",
            "11222",
            "11223",
            "11224",
            "11225",
            "11226",
            "11228",
            "11229",
            "11230",
            "11231",
            "11232",
            "11233",
            "11234",
            "11235",
            "11236",
            "11237",
            "11238",
            "11239",
            # Queens - Key Areas
            "11101",
            "11102",
            "11103",
            "11104",
            "11105",
            "11106",
            "11109",
            "11354",
            "11355",
            "11356",
            "11357",
            "11358",
            "11359",
            "11360",
            "11361",
            "11362",
            "11363",
            "11364",
            "11365",
            "11366",
            "11367",
            "11368",
            "11369",
            "11370",
            "11372",
            "11373",
            "11374",
            "11375",
            "11377",
            "11378",
            "11379",
            "11385",
            # Bronx - Major Districts
            "10451",
            "10452",
            "10453",
            "10454",
            "10455",
            "10456",
            "10457",
            "10458",
            "10459",
            "10460",
            "10461",
            "10462",
            "10463",
            "10464",
            "10465",
            "10466",
            "10467",
            "10468",
            "10469",
            "10470",
            "10471",
            "10472",
            "10473",
            "10474",
            "10475",
            # Staten Island
            "10301",
            "10302",
            "10303",
            "10304",
            "10305",
            "10306",
            "10307",
            "10308",
            "10309",
            "10310",
            "10311",
            "10312",
            "10313",
            "10314",
        ],
    ),
    # Los Angeles Metropolitan Area
    "la": MetropolitanArea(
        name="Los Angeles",
        code="la",
        description="Los Angeles County core areas",
        state="CA",
        population=4_000_000,
        density_category="high",
        market_characteristics=[
            "fitness_culture",
            "outdoor_fitness",
            "celebrity_clientele",
            "innovative_concepts",
            "wellness_focused",
            "beach_proximity",
        ],
        zip_codes=[
            # Downtown/Central LA
            "90012",
            "90013",
            "90014",
            "90015",
            "90017",
            "90028",
            "90029",
            "90038",
            "90039",
            "90026",
            "90027",
            "90004",
            "90005",
            "90006",
            "90007",
            "90008",
            # West LA/Beverly Hills/Hollywood
            "90069",
            "90048",
            "90046",
            "90036",
            "90035",
            "90034",
            "90019",
            "90018",
            "90016",
            "90210",
            "90211",
            "90212",
            "90213",
            "90077",
            "90067",
            "90064",
            "90024",
            "90025",
            "90049",
            "90073",
            "90272",
            "90291",
            "90292",
            "90293",
            # Santa Monica/Venice/Marina del Rey
            "90401",
            "90402",
            "90403",
            "90404",
            "90405",
            "90291",
            "90292",
            "90293",
            # Hollywood/West Hollywood
            "90028",
            "90038",
            "90046",
            "90069",
            "90048",
            "90036",
            # Westside Communities
            "90230",
            "90231",
            "90232",
            "90233",
            "90301",
            "90302",
            "90303",
            "90304",
            "90305",
            "90501",
            "90502",
            "90503",
            "90504",
            "90505",
            "90506",
            "90507",
            "90508",
            "90509",
            "90510",
        ],
    ),
    # Chicago Metropolitan Area
    "chicago": MetropolitanArea(
        name="Chicago",
        code="chicago",
        description="Chicago city core and near suburbs",
        state="IL",
        population=2_700_000,
        density_category="high",
        market_characteristics=[
            "blue_collar_fitness",
            "neighborhood_gyms",
            "affordable_options",
            "winter_indoor_focus",
            "community_oriented",
            "diverse_demographics",
        ],
        zip_codes=[
            # Downtown/Loop/Near North
            "60601",
            "60602",
            "60603",
            "60604",
            "60605",
            "60606",
            "60607",
            "60608",
            "60610",
            "60611",
            "60612",
            "60613",
            "60614",
            "60615",
            "60616",
            "60617",
            "60618",
            "60619",
            "60620",
            "60621",
            "60622",
            "60623",
            "60624",
            "60625",
            "60626",
            "60628",
            "60629",
            "60630",
            "60631",
            "60632",
            "60633",
            "60634",
            "60636",
            "60637",
            "60638",
            "60639",
            "60640",
            "60641",
            "60642",
            "60643",
            "60644",
            "60645",
            "60646",
            "60647",
            "60649",
            "60651",
            "60652",
            "60653",
            "60654",
            "60655",
            "60656",
            "60657",
            "60659",
            "60660",
            "60661",
            "60664",
            "60666",
            "60668",
            "60669",
            "60670",
            "60673",
            "60674",
            "60675",
            "60677",
            "60678",
            "60680",
            "60681",
            "60682",
            "60684",
            "60685",
            "60686",
            "60687",
            "60688",
            "60689",
            "60690",
            "60691",
            "60693",
            "60694",
            "60695",
            "60696",
            "60697",
            "60699",
        ],
    ),
    # San Francisco Bay Area
    "sf": MetropolitanArea(
        name="San Francisco Bay Area",
        code="sf",
        description="San Francisco, Oakland, San Jose core areas",
        state="CA",
        population=4_700_000,
        density_category="very_high",
        market_characteristics=[
            "tech_professionals",
            "premium_pricing",
            "innovative_fitness",
            "health_conscious",
            "boutique_focus",
            "sustainability_minded",
        ],
        zip_codes=[
            # San Francisco
            "94102",
            "94103",
            "94104",
            "94105",
            "94107",
            "94108",
            "94109",
            "94110",
            "94111",
            "94112",
            "94114",
            "94115",
            "94116",
            "94117",
            "94118",
            "94121",
            "94122",
            "94123",
            "94124",
            "94127",
            "94129",
            "94130",
            "94131",
            "94132",
            "94133",
            "94134",
            "94158",
            # Oakland
            "94601",
            "94602",
            "94603",
            "94605",
            "94606",
            "94607",
            "94608",
            "94609",
            "94610",
            "94611",
            "94612",
            "94618",
            "94619",
            "94621",
            # Berkeley/Richmond/Other East Bay
            "94702",
            "94703",
            "94704",
            "94705",
            "94706",
            "94707",
            "94708",
            "94709",
            "94801",
            "94802",
            "94803",
            "94804",
            "94805",
            "94806",
            "94807",
            "94808",
            # San Jose (selected core areas)
            "95110",
            "95112",
            "95113",
            "95116",
            "95117",
            "95118",
            "95119",
            "95120",
            "95121",
            "95122",
            "95123",
            "95124",
            "95125",
            "95126",
            "95127",
            "95128",
            "95129",
            "95130",
            "95131",
            "95132",
            "95133",
            "95134",
            "95135",
            "95136",
            "95138",
            "95139",
        ],
    ),
    # Boston Metropolitan Area
    "boston": MetropolitanArea(
        name="Boston",
        code="boston",
        description="Boston city and Cambridge/Somerville area",
        state="MA",
        population=685_000,
        density_category="high",
        market_characteristics=[
            "college_town",
            "health_conscious",
            "seasonal_fitness",
            "professional_clientele",
            "historic_neighborhoods",
            "walking_culture",
        ],
        zip_codes=[
            # Boston Core
            "02101",
            "02102",
            "02103",
            "02104",
            "02105",
            "02106",
            "02107",
            "02108",
            "02109",
            "02110",
            "02111",
            "02112",
            "02113",
            "02114",
            "02115",
            "02116",
            "02117",
            "02118",
            "02119",
            "02120",
            "02121",
            "02122",
            "02123",
            "02124",
            "02125",
            "02126",
            "02127",
            "02128",
            "02129",
            "02130",
            "02131",
            "02132",
            "02133",
            "02134",
            "02135",
            "02136",
            "02137",
            "02163",
            "02196",
            "02199",
            "02203",
            "02204",
            "02205",
            "02206",
            "02210",
            "02211",
            "02212",
            "02215",
            "02217",
            "02222",
            "02266",
            "02283",
            "02284",
            "02293",
            "02295",
            "02297",
            "02298",
            # Cambridge
            "02138",
            "02139",
            "02140",
            "02141",
            "02142",
            # Somerville
            "02143",
            "02144",
            "02145",
        ],
    ),
    # Miami-Dade Metropolitan Area
    "miami": MetropolitanArea(
        name="Miami",
        code="miami",
        description="Miami-Dade County core areas",
        state="FL",
        population=2_700_000,
        density_category="high",
        market_characteristics=[
            "beach_fitness",
            "latin_culture",
            "luxury_market",
            "outdoor_year_round",
            "body_conscious",
            "nightlife_integration",
            "international_clientele",
        ],
        zip_codes=[
            # Miami Beach
            "33139",
            "33140",
            "33141",
            "33154",
            # Downtown Miami/Brickell
            "33128",
            "33129",
            "33130",
            "33131",
            "33132",
            "33133",
            "33134",
            "33135",
            "33136",
            "33137",
            "33138",
            "33142",
            "33143",
            "33144",
            "33145",
            "33146",
            "33147",
            "33150",
            "33155",
            "33156",
            "33157",
            "33158",
            "33161",
            "33162",
            "33163",
            "33164",
            "33165",
            "33166",
            "33167",
            "33168",
            "33169",
            "33170",
            "33172",
            "33173",
            "33174",
            "33175",
            "33176",
            "33177",
            "33178",
            "33179",
            "33180",
            "33181",
            "33182",
            "33183",
            "33184",
            "33185",
            "33186",
            "33187",
            "33188",
            "33189",
            "33190",
            "33193",
            "33194",
            "33196",
            "33197",
            "33199",
        ],
    ),
}


def get_metro_area(code: str) -> Optional[MetropolitanArea]:
    """Get metropolitan area by code"""
    return METROPOLITAN_AREAS.get(code.lower())


def list_metro_areas() -> List[str]:
    """List all available metropolitan area codes"""
    return list(METROPOLITAN_AREAS.keys())


def get_metro_zip_codes(code: str) -> List[str]:
    """Get ZIP codes for a metropolitan area"""
    metro = get_metro_area(code)
    return metro.zip_codes if metro else []


def search_metro_areas(query: str) -> List[MetropolitanArea]:
    """Search metropolitan areas by name or characteristics"""
    query_lower = query.lower()
    results = []

    for metro in METROPOLITAN_AREAS.values():
        # Search in name, description, or market characteristics
        if (
            query_lower in metro.name.lower()
            or query_lower in metro.description.lower()
            or any(query_lower in char.lower() for char in metro.market_characteristics)
        ):
            results.append(metro)

    return results


def get_metro_summary() -> Dict[str, dict]:
    """Get summary statistics for all metropolitan areas"""
    summary = {}

    for code, metro in METROPOLITAN_AREAS.items():
        summary[code] = {
            "name": metro.name,
            "zip_count": len(metro.zip_codes),
            "population": metro.population,
            "density": metro.density_category,
            "characteristics": metro.market_characteristics[:3],  # Top 3
        }

    return summary


if __name__ == "__main__":
    # Demo/Test the metropolitan area definitions
    print("üèôÔ∏è  GymIntel Metropolitan Area Definitions")
    print("=" * 50)

    for code, metro in METROPOLITAN_AREAS.items():
        print(f"\nüìç {metro.name} ({code.upper()})")
        print(f"   ZIP Codes: {len(metro.zip_codes)} areas")
        print(f"   Population: {metro.population:,}" if metro.population else "   Population: N/A")
        print(f"   Density: {metro.density_category}")
        print(f"   Market: {', '.join(metro.market_characteristics[:3])}")
        print(f"   Sample ZIPs: {', '.join(metro.zip_codes[:5])}...")

    print(f"\nüìä Total: {len(METROPOLITAN_AREAS)} metropolitan areas defined")
    print(f"üìä Total ZIP codes: {sum(len(m.zip_codes) for m in METROPOLITAN_AREAS.values())}")
